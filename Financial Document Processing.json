{
  "name": "Financial Document Processing",
  "nodes": [
    {
      "parameters": {
        "options": {
          "allowFileUploads": true,
          "allowedFilesMimeTypes": "*"
        }
      },
      "id": "05c30f77-c4e0-4b42-b618-969496b0dfbd",
      "name": "When chat message received",
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "position": [
        992,
        4416
      ],
      "webhookId": "9915b6a2-5823-45b1-9b42-95f428906e87",
      "typeVersion": 1.1
    },
    {
      "parameters": {
        "fieldToSplitOut": "parsedData['Line Items']",
        "options": {}
      },
      "id": "d25e6859-5bc0-49d9-ba45-8862168e4994",
      "name": "Split Out",
      "type": "n8n-nodes-base.splitOut",
      "position": [
        1680,
        4624
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# Mark - Accountant\n\n![My Image](https://i.postimg.cc/XqKMCBkM/Chat-GPT-Image-Apr-25-2025-06-09-53-AM.png)\n\n",
        "height": 420,
        "width": 340
      },
      "id": "5ae5d7b3-8126-4a72-b700-55e6fc36ee0b",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        576,
        4416
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "de0be0e9-b008-40c1-84a6-c350ec326840",
              "name": "confirmation",
              "type": "string",
              "value": "All invoices have been processed"
            }
          ]
        },
        "options": {}
      },
      "id": "0b647210-4a84-47d2-b6da-0c9c20da940b",
      "name": "Confirmation",
      "type": "n8n-nodes-base.set",
      "position": [
        2320,
        4416
      ],
      "typeVersion": 3.4
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "ac4cf2cc-36af-47a4-8638-852302ec2dbd",
              "name": "parsedData",
              "type": "object",
              "value": "={{$json[\"candidates\"][0][\"content\"][\"parts\"][0][\"text\"].replace(/^```json\\s*|\\s*```$/g, '')}}\n"
            }
          ]
        },
        "options": {
          "ignoreConversionErrors": true
        }
      },
      "id": "eb36f975-3346-47e5-b4b0-797ab54301d1",
      "name": "Parsed Data",
      "type": "n8n-nodes-base.set",
      "position": [
        1504,
        4624
      ],
      "retryOnFail": true,
      "typeVersion": 3.4
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/upload/v1beta/files",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "googlePalmApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/pdf"
            }
          ]
        },
        "sendBody": true,
        "contentType": "binaryData",
        "inputDataFieldName": "data0",
        "options": {}
      },
      "id": "9916a1cc-eb12-4cf7-9152-a3f3d1b0fc6d",
      "name": "Upload PDF to Google Gemini",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1120,
        4624
      ],
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-04-17:generateContent",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "googlePalmApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\": [\n    {\n      \"role\": \"user\",\n      \"parts\": [\n        {\n          \"text\": \"Read and analyze this document. If it is an invoice, extract and return the following fields in JSON format:\\\\n- Vendor Name\\\\n- Invoice Number\\\\n- Invoice Date\\\\n- Due Date\\\\n- Total Amount\\\\n- VAT Amount\\\\n- Line Items (Description, Quantity, Unit Price, Total Price)\\\\nIf it is not an invoice, summarize the document content instead in plain text.\"\n        },\n        {\n          \"file_data\": {\n            \"mime_type\": \"application/pdf\",\n            \"file_uri\": {{ JSON.stringify($json.file.uri) }}\n          }\n        }\n      ]\n    }\n  ],\n  \"generationConfig\": {\n    \"responseMimeType\": \"text/plain\",\n    \"maxOutputTokens\": 32768\n  }\n}\n",
        "options": {}
      },
      "id": "862951c8-00ee-4bb7-a46c-9c6d343ddbe0",
      "name": "Download Data from Google Gemini",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1312,
        4624
      ],
      "typeVersion": 4.2,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "mode": "list",
          "value": "1Gjm3ALhZZ7I4Wto0CZYNuEr48K-bgLLK6M8K4eyuPq0",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Gjm3ALhZZ7I4Wto0CZYNuEr48K-bgLLK6M8K4eyuPq0/edit?usp=drivesdk",
          "cachedResultName": "Test Invoice Records"
        },
        "sheetName": {
          "__rl": true,
          "mode": "list",
          "value": "gid=0",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Gjm3ALhZZ7I4Wto0CZYNuEr48K-bgLLK6M8K4eyuPq0/edit#gid=0",
          "cachedResultName": "Sheet1"
        },
        "columns": {
          "value": {
            "Due Date": "={{ $('Parsed Data').item.json.parsedData['Due Date'] }}",
            "Quantity": "={{ $json.Quantity }}",
            "Unit Price": "={{ $json['Unit Price'] }}",
            "VAT Amount": "={{ $('Parsed Data').item.json.parsedData['VAT Amount'] }}",
            "Total Price": "={{ $json['Total Price'] }}",
            "Vendor Name": "={{ $('Parsed Data').item.json.parsedData['Vendor Name'] }}",
            "Invoice Date": "={{ $('Parsed Data').item.json.parsedData['Invoice Date'] }}",
            "Total Amount": "={{ $('Parsed Data').item.json.parsedData['Total Amount'] }}",
            "Invoice Number": "={{ $('Parsed Data').item.json.parsedData['Invoice Number'] }}",
            "Line Item Description": "={{ $json.Description }}"
          },
          "schema": [
            {
              "id": "Vendor Name",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Vendor Name",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Invoice Number",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Invoice Number",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Invoice Date",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Invoice Date",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Due Date",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Due Date",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Total Amount",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Total Amount",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "VAT Amount",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "VAT Amount",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Line Item Description",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Line Item Description",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Quantity",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Quantity",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Unit Price",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Unit Price",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Total Price",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Total Price",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "cellFormat": "USER_ENTERED"
        }
      },
      "id": "fdc59478-ff48-4aae-ace2-e1fe80c3aafe",
      "name": "Table ERP",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        1840,
        4624
      ],
      "typeVersion": 4.5
    },
    {
      "parameters": {},
      "id": "b553a149-71d8-4d2b-b372-be62d7d86a8a",
      "name": "When Executed by Another Workflow",
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "position": [
        976,
        1456
      ],
      "typeVersion": 1.1,
      "disabled": true
    },
    {
      "parameters": {},
      "id": "2d364b37-1d8f-44f4-8101-649e2e07b828",
      "name": "Merge",
      "type": "n8n-nodes-base.merge",
      "position": [
        1968,
        4416
      ],
      "typeVersion": 3.1
    },
    {
      "parameters": {
        "operation": "update",
        "fileId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $json.id }}"
        },
        "newUpdatedFileName": "={{$('Table ERP').first().json['Vendor Name']}} - {{$('Table ERP').first().json['Invoice Number']}}",
        "options": {}
      },
      "id": "1f4e290b-00a6-4d83-a185-28bc68507745",
      "name": "Update File Name",
      "type": "n8n-nodes-base.googleDrive",
      "position": [
        2144,
        4416
      ],
      "typeVersion": 3,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "inputDataFieldName": "data0",
        "name": "={{ $json.files[0].fileName }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "mode": "list",
          "value": "1nCCa5nxntHv4u-2hSKG9K3cBxrQhA32O",
          "cachedResultUrl": "https://drive.google.com/drive/folders/1nCCa5nxntHv4u-2hSKG9K3cBxrQhA32O",
          "cachedResultName": "Invoices"
        },
        "options": {}
      },
      "id": "84582254-0d7b-47c5-875f-b0daff4cbeec",
      "name": "Save Invoice",
      "type": "n8n-nodes-base.googleDrive",
      "position": [
        1312,
        4416
      ],
      "typeVersion": 3
    },
    {
      "parameters": {
        "content": "# Invoice Processing",
        "height": 528,
        "width": 1988,
        "color": 5
      },
      "id": "0128bcdf-2fb5-48c2-9402-d88de4ea2db0",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        560,
        4336
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# Expenses Processing",
        "height": 608,
        "width": 1604,
        "color": 5
      },
      "id": "bb4bad59-d0bf-4c51-8805-1720be7b809e",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        560,
        3360
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# Donna - Accountant\n\n![My Image](https://i.postimg.cc/yY6MHQ0m/Chat-GPT-Image-Apr-25-2025-12-19-57-PM.png)\n\n",
        "height": 480,
        "width": 340
      },
      "id": "0df072e6-cec5-466f-9112-88c7f40b9900",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        576,
        3440
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "triggerOn": "specificFolder",
        "folderToWatch": {
          "__rl": true,
          "mode": "list",
          "value": "1vBeKYr7XpinvUUCNYDKOiNIhNcDI5By_",
          "cachedResultUrl": "https://drive.google.com/drive/folders/1vBeKYr7XpinvUUCNYDKOiNIhNcDI5By_",
          "cachedResultName": "Expense Receipts"
        },
        "event": "fileCreated",
        "options": {}
      },
      "id": "b84b6a71-4f7e-42a1-90da-cbb010fdc584",
      "name": "Google Drive Trigger",
      "type": "n8n-nodes-base.googleDriveTrigger",
      "position": [
        1008,
        3584
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "fieldToSplitOut": "parsedData['Line Items']",
        "options": {}
      },
      "id": "0eff44dd-8acd-40e6-8d81-a6d1689f48ad",
      "name": "Split Out1",
      "type": "n8n-nodes-base.splitOut",
      "position": [
        1952,
        3424
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "ac4cf2cc-36af-47a4-8638-852302ec2dbd",
              "name": "parsedData",
              "type": "object",
              "value": "={{$json[\"candidates\"][0][\"content\"][\"parts\"][0][\"text\"].replace(/^```json\\s*|\\s*```$/g, '')}}\n"
            }
          ]
        },
        "options": {
          "ignoreConversionErrors": true
        }
      },
      "id": "e4f45bce-d133-40ee-bdb1-583ef08e2c78",
      "name": "Parsed Data1",
      "type": "n8n-nodes-base.set",
      "position": [
        1792,
        3376
      ],
      "retryOnFail": true,
      "typeVersion": 3.4
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/upload/v1beta/files",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "googlePalmApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/pdf"
            }
          ]
        },
        "sendBody": true,
        "contentType": "binaryData",
        "inputDataFieldName": "data",
        "options": {}
      },
      "id": "c82afc0d-60dd-4042-9268-42388a46d80c",
      "name": "Upload PDF to Google Gemini1",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1392,
        3376
      ],
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-04-17:generateContent",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "googlePalmApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\": [\n    {\n      \"role\": \"user\",\n      \"parts\": [\n        {\n          \"text\": \"Read and analyze this document. If it is an expense receipt, extract and return the following fields in JSON format:\\n- Merchant Name\\n- Transaction Date\\n- Total Amount\\n- Tax Amount (if available)\\n- Payment Method\\n- Line Items (Description, Quantity, Unit Price, Total Price) if available\\nIf it is not an expense receipt, summarize the document content instead in plain text.\"\n        },\n        {\n          \"file_data\": {\n            \"mime_type\": \"application/pdf\",\n            \"file_uri\": {{ JSON.stringify($json.file.uri) }}\n          }\n        }\n      ]\n    }\n  ],\n  \"generationConfig\": {\n    \"responseMimeType\": \"text/plain\",\n    \"maxOutputTokens\": 32768\n  }\n}\n",
        "options": {}
      },
      "id": "ba7e86aa-54c1-47e4-ac01-303b344ab11f",
      "name": "Download Data from Google Gemini1",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1584,
        3376
      ],
      "typeVersion": 4.2,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "mode": "list",
          "value": "1zhOaSKk29dp0xzL8u3yVY62FEFxuo1I-9hc1pfAsQjs",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1zhOaSKk29dp0xzL8u3yVY62FEFxuo1I-9hc1pfAsQjs/edit?usp=drivesdk",
          "cachedResultName": "Expenses Recording"
        },
        "sheetName": {
          "__rl": true,
          "mode": "list",
          "value": "gid=0",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1zhOaSKk29dp0xzL8u3yVY62FEFxuo1I-9hc1pfAsQjs/edit#gid=0",
          "cachedResultName": "Sheet1"
        },
        "columns": {
          "value": {
            "Category": "={{ $json.output.category }}",
            "Quantity": "={{ $('Split Out1').item.json.Quantity }}",
            "Tax Amount": "={{ $('Parsed Data1').item.json.parsedData['Tax Amount'] }}",
            "Unit Price": "={{ $('Split Out1').item.json['Unit Price'] }}",
            "Total Price": "={{ $('Split Out1').item.json['Total Price'] }}",
            "Total Amount": "={{ $('Parsed Data1').item.json.parsedData['Total Amount'] }}",
            "Merchant Name": "={{ $('Parsed Data1').item.json.parsedData['Merchant Name'] }}",
            "Payment Method": "={{ $('Parsed Data1').item.json.parsedData['Payment Method'] }}",
            "Transaction Date": "={{ $('Parsed Data1').item.json.parsedData['Transaction Date'] }}",
            "Line Item Description": "={{ $('Split Out1').item.json.Description }}"
          },
          "schema": [
            {
              "id": "Merchant Name",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Merchant Name",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Transaction Date",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Transaction Date",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Total Amount",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Total Amount",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Tax Amount",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Tax Amount",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Category",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "Category",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Payment Method",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Payment Method",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Line Item Description",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Line Item Description",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Quantity",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Quantity",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Unit Price",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Unit Price",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Total Price",
              "type": "string",
              "display": true,
              "required": false,
              "displayName": "Total Price",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "cellFormat": "USER_ENTERED"
        }
      },
      "id": "1df86ad6-0228-46a8-bf06-46967da250b0",
      "name": "Google Sheets",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        1744,
        3632
      ],
      "typeVersion": 4.5
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $json.id }}"
        },
        "options": {}
      },
      "id": "2a7b7331-c18e-41e0-9321-23541eb1c2be",
      "name": "Google Drive",
      "type": "n8n-nodes-base.googleDrive",
      "position": [
        1184,
        3376
      ],
      "typeVersion": 3
    },
    {
      "parameters": {
        "content": "# Expenses Processing",
        "height": 512,
        "width": 2136,
        "color": 5
      },
      "id": "209ecbb1-ce9c-4b1d-b618-76f6e993d035",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        560,
        2368
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# Victor - Controller\n![My Image](https://i.postimg.cc/m2fryF1z/Chat-GPT-Image-Apr-25-2025-05-10-57-PM.png)\n\n",
        "height": 420,
        "width": 340
      },
      "id": "37051250-b241-4acf-8cff-c43e1957b67a",
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        576,
        2448
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "triggerOn": "specificFolder",
        "folderToWatch": {
          "__rl": true,
          "mode": "list",
          "value": "16l6LegAqkV6axZT9WPwr_p2-20VqeiRD",
          "cachedResultUrl": "https://drive.google.com/drive/folders/16l6LegAqkV6axZT9WPwr_p2-20VqeiRD",
          "cachedResultName": "Bank Statements"
        },
        "event": "fileCreated",
        "options": {}
      },
      "id": "7aadd42e-b7aa-4cf7-b8b2-770bea859315",
      "name": "Google Drive Trigger1",
      "type": "n8n-nodes-base.googleDriveTrigger",
      "position": [
        1072,
        2528
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/upload/v1beta/files",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "googlePalmApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/pdf"
            }
          ]
        },
        "sendBody": true,
        "contentType": "binaryData",
        "inputDataFieldName": "data",
        "options": {}
      },
      "id": "952fe2c6-a502-4463-a830-3ab55227e3d0",
      "name": "Upload PDF to Google Gemini2",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1600,
        2528
      ],
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-04-17:generateContent",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "googlePalmApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"contents\": [\n    {\n      \"role\": \"user\",\n      \"parts\": [\n        {\n          \"text\": \"Read and analyze this document. If it is a bank statement, extract and return the following fields in JSON format:\\n- Txn ID\\n- Date\\n- Description / Payee\\n- Debit (-)\\n- Credit (+)\\n- Currency\\n- Running Balance\\n- Notes / Category (optional)\\n\\nIf it is not a bank statement, summarize the document content instead in plain text.\"\n        },\n        {\n          \"file_data\": {\n            \"mime_type\": \"application/pdf\",\n            \"file_uri\": {{ JSON.stringify($json.file.uri) }}\n          }\n        }\n      ]\n    }\n  ],\n  \"generationConfig\": {\n    \"responseMimeType\": \"text/plain\",\n    \"maxOutputTokens\": 32768\n  }\n}\n",
        "options": {}
      },
      "id": "68ba0c6d-8271-4224-9c69-104dda2f8af5",
      "name": "Download Data from Google Gemini2",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1808,
        2528
      ],
      "typeVersion": 4.2,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "mode": "list",
          "value": "1SOknw2I6hgXwwaaRHPPogtGjCP4pUjK-xsfIYYwJnvo",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1SOknw2I6hgXwwaaRHPPogtGjCP4pUjK-xsfIYYwJnvo/edit?usp=drivesdk",
          "cachedResultName": "Bank Transactions Record"
        },
        "sheetName": {
          "__rl": true,
          "mode": "list",
          "value": "gid=0",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1SOknw2I6hgXwwaaRHPPogtGjCP4pUjK-xsfIYYwJnvo/edit#gid=0",
          "cachedResultName": "Sheet1"
        },
        "columns": {
          "value": {
            "Date": "={{ $json.Date }}",
            "Currency": "={{ $json.Currency }}",
            "Debit (-)": "={{ $json['Debit (-)'] }}",
            "Credit (+)": "={{ $json['Credit (+)'] }}",
            "Running Balance": "={{ $json['Running Balance'] }}",
            "Description / Payee": "={{ $json['Description / Payee'] }}"
          },
          "schema": [
            {
              "id": "Transaction ID",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "Transaction ID",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Date",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "Date",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Description / Payee",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "Description / Payee",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Debit (-)",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "Debit (-)",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Credit (+)",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "Credit (+)",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Currency",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "Currency",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Running Balance",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "Running Balance",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            },
            {
              "id": "Notes / Category",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "Notes / Category",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "cellFormat": "USER_ENTERED"
        }
      },
      "id": "d2d4b7b1-a272-4353-a1d9-363bdb324f17",
      "name": "Google Sheets1",
      "type": "n8n-nodes-base.googleSheets",
      "position": [
        2288,
        2528
      ],
      "typeVersion": 4.5
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ $json.id }}"
        },
        "options": {}
      },
      "id": "c008c632-6862-4281-b8a1-7abd2ef6d4d1",
      "name": "Google Drive1",
      "type": "n8n-nodes-base.googleDrive",
      "position": [
        1296,
        2528
      ],
      "typeVersion": 3
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "9f21fb2a-c48b-4918-ba56-c98384e1546d",
              "name": "response",
              "type": "string",
              "value": "Recorded!"
            }
          ]
        },
        "options": {}
      },
      "id": "e9a3ebd0-ddf0-4ccf-9e97-ac12731a8fd3",
      "name": "Edit Fields",
      "type": "n8n-nodes-base.set",
      "position": [
        2464,
        2528
      ],
      "typeVersion": 3.4
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "9f21fb2a-c48b-4918-ba56-c98384e1546d",
              "name": "response",
              "type": "string",
              "value": "Recorded!"
            }
          ]
        },
        "options": {}
      },
      "id": "182fa39e-909d-4c2b-9aa2-5eecda2b719f",
      "name": "Edit Fields1",
      "type": "n8n-nodes-base.set",
      "position": [
        1952,
        3632
      ],
      "typeVersion": 3.4
    },
    {
      "parameters": {
        "jsCode": "const raw = $json.candidates[0].content.parts[0].text;\nconst match = raw.match(/```json\\s*([\\s\\S]*?)\\s*```/);\nlet body   = (match ? match[1] : raw)\n\t           .replace(/[\\u0000-\\u001F\\u007F-\\u009F]/g, '')\n\t           .replace(/,\\s*([}\\]])/g, '$1');\n\nlet data;\ntry {\n\tdata = JSON.parse(body);            // â† will throw a readable n8n error if still bad\n} catch (err) {\n\tthrow new Error('LLM returned invalid JSON âœ ' + err.message);\n}\n\n// Normalise: array of rows no matter what\nif (!Array.isArray(data)) data = data.transactions || [data];\nreturn data.map(t => ({ json: t }));\n"
      },
      "id": "7384b4e3-105e-47e2-9cae-03d5e1b58999",
      "name": "Code",
      "type": "n8n-nodes-base.code",
      "position": [
        2064,
        2528
      ],
      "typeVersion": 2
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('Download Data from Google Gemini1').item.json.candidates[0].content.parts[0].text }}",
        "hasOutputParser": true,
        "messages": {
          "messageValues": [
            {
              "message": "=You are EXPENSE-CLASSIFIER, an expert bookkeeping agent.\n\nTask  \nâ€¢ Read the input text of one expense (bank-transaction line, receipt, or invoice memo).  \nâ€¢ Choose exactly **one** category from the allowed list below that best fits.  \nâ€¢ If no perfect fit exists, pick the closest logical category (never return â€œunknownâ€).  \nâ€¢ Respond ONLY with valid JSON that matches the schema in the next blockâ€”no extra keys, no markdown.\n\nAllowed categories  \n- Cost of Goods Sold  \n- Advertising & Marketing  \n- Payroll & Wages  \n- Employee Benefits  \n- Contract Labor  \n- Rent & Leases  \n- Utilities  \n- Office Supplies & G&A  \n- Software & Cloud Subscriptions  \n- Travel Meals & Entertainment  \n- Professional Services  \n- Insurance  \n- Repairs & Maintenance  \n- Taxes & Licenses  \n- Interest Expense  \n- Depreciation & Amortization  \n- Other Miscellaneous\n"
            }
          ]
        }
      },
      "id": "bf5a3f46-89d9-4b8e-951a-462857cefc5c",
      "name": "Basic LLM Chain",
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "position": [
        1392,
        3632
      ],
      "typeVersion": 1.6
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "381a8c73-367c-474c-9648-a6bb745a9b45",
      "name": "OpenRouter Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "position": [
        1392,
        3808
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"category\": \"Advertising & Marketing\"\n}\n"
      },
      "id": "ed7365c4-490d-432f-bbcf-1f0941e0a533",
      "name": "Structured Output Parser",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "position": [
        1536,
        3808
      ],
      "typeVersion": 1.2
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json }}",
        "options": {
          "systemMessage": "You are FinanceDataBot, a specialized agent for extracting and analyzing financial data from spreadsheets.\n\nPRIMARY FUNCTION:\nYour sole purpose is to access, extract, and analyze data from financial spreadsheets when requested by an orchestrator agent. You have access to three key spreadsheets:\n1. Invoices - Contains invoice records with details on clients, amounts, dates, and payment status\n2. Expenses - Contains expense records with categories, amounts, dates, and other relevant details\n3. Transactions - Contains bank transaction records with dates, descriptions, amounts, and transaction types\n\nRESPONSE GUIDELINES:\n1. Always respond with accurate, concise data extractions based on the specific request\n2. Format numerical data appropriately (currency with 2 decimal places)\n3. When providing lists, use clean table formatting\n4. Include summary statistics when appropriate (totals, averages, etc.)\n5. Never share opinions or engage in casual conversation - stay focused on data extraction only\n\nDATA EXTRACTION CAPABILITIES:\n- Filter by date ranges (e.g., \"invoices for December\")\n- Sort and limit results (e.g., \"last 10 transactions\")\n- Calculate aggregates (e.g., \"total value of invoices\")\n- Perform basic analysis (e.g., \"highest expense category\")\n- Identify patterns or anomalies when specifically requested\n\nERROR HANDLING:\n- If data is missing or unavailable, clearly state what information could not be retrieved\n- If a request is ambiguous, ask for clarification on specific parameters needed\n- If a request is outside your capabilities, explain what you can and cannot provide\n\nSECURITY CONSIDERATIONS:\n- You only have access to the three specified spreadsheets\n- Do not attempt to access or modify any other data sources\n- Treat all financial data as confidential\n\nExample requests you should be able to handle:\n- \"What are the last 10 bank transactions?\"\n- \"What is the total value of invoices for December 2023?\"\n- \"List all unpaid invoices sorted by amount\"\n- \"What was our highest expense category last month?\"\n- \"Show me transactions over $1000 in the past week\"\n- \"Calculate the average invoice amount by client\""
        }
      },
      "id": "ba5e057e-0191-4ac7-8ec2-01f7fbad8711",
      "name": "AI Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [
        1200,
        1456
      ],
      "typeVersion": 1.9
    },
    {
      "parameters": {
        "model": "openai/gpt-4.1",
        "options": {}
      },
      "id": "e58a65b1-982e-4064-be4f-bc27954300d8",
      "name": "OpenRouter Chat Model1",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "position": [
        1104,
        1696
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "mode": "list",
          "value": "1Gjm3ALhZZ7I4Wto0CZYNuEr48K-bgLLK6M8K4eyuPq0",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Gjm3ALhZZ7I4Wto0CZYNuEr48K-bgLLK6M8K4eyuPq0/edit?usp=drivesdk",
          "cachedResultName": "Test Invoice Records"
        },
        "sheetName": {
          "__rl": true,
          "mode": "list",
          "value": "gid=0",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1Gjm3ALhZZ7I4Wto0CZYNuEr48K-bgLLK6M8K4eyuPq0/edit#gid=0",
          "cachedResultName": "Sheet1"
        },
        "options": {
          "dataLocationOnSheet": {
            "values": {
              "rangeDefinition": "detectAutomatically"
            }
          }
        }
      },
      "id": "71dd2f3b-2492-4156-a2e9-4f8246f73813",
      "name": "Invoices",
      "type": "n8n-nodes-base.googleSheetsTool",
      "position": [
        1424,
        1696
      ],
      "typeVersion": 4.5
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "mode": "list",
          "value": "1zhOaSKk29dp0xzL8u3yVY62FEFxuo1I-9hc1pfAsQjs",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1zhOaSKk29dp0xzL8u3yVY62FEFxuo1I-9hc1pfAsQjs/edit?usp=drivesdk",
          "cachedResultName": "Expenses Recording"
        },
        "sheetName": {
          "__rl": true,
          "mode": "list",
          "value": "gid=0",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1zhOaSKk29dp0xzL8u3yVY62FEFxuo1I-9hc1pfAsQjs/edit#gid=0",
          "cachedResultName": "Sheet1"
        },
        "options": {
          "dataLocationOnSheet": {
            "values": {
              "rangeDefinition": "detectAutomatically"
            }
          }
        }
      },
      "id": "abee6f37-d838-4777-b74b-cb58987a0757",
      "name": "Expenses",
      "type": "n8n-nodes-base.googleSheetsTool",
      "position": [
        1520,
        1696
      ],
      "typeVersion": 4.5
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "mode": "list",
          "value": "1SOknw2I6hgXwwaaRHPPogtGjCP4pUjK-xsfIYYwJnvo",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1SOknw2I6hgXwwaaRHPPogtGjCP4pUjK-xsfIYYwJnvo/edit?usp=drivesdk",
          "cachedResultName": "Bank Transactions Record"
        },
        "sheetName": {
          "__rl": true,
          "mode": "list",
          "value": "gid=0",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1SOknw2I6hgXwwaaRHPPogtGjCP4pUjK-xsfIYYwJnvo/edit#gid=0",
          "cachedResultName": "Sheet1"
        },
        "options": {
          "dataLocationOnSheet": {
            "values": {
              "rangeDefinition": "detectAutomatically"
            }
          }
        }
      },
      "id": "eb20a724-99a7-45ce-960e-7fb5776b121d",
      "name": "Transactions",
      "type": "n8n-nodes-base.googleSheetsTool",
      "position": [
        1616,
        1696
      ],
      "typeVersion": 4.5
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "599d7fa9-e8c5-4c3a-8957-f94c498014bd",
              "name": "Response",
              "type": "string",
              "value": "={{ $json }}"
            }
          ]
        },
        "options": {}
      },
      "id": "3eb4df8e-0f24-429d-9918-6ed06dc90b6a",
      "name": "Edit Fields2",
      "type": "n8n-nodes-base.set",
      "position": [
        1552,
        1456
      ],
      "typeVersion": 3.4
    },
    {
      "parameters": {
        "content": "# Andrew - CFO\n\n![My Image](https://i.postimg.cc/xT23Z3Ty/Chat-GPT-Image-Apr-24-2025-08-02-30-AM.png)\n",
        "height": 420,
        "width": 340
      },
      "id": "f8b2c182-8b91-4939-81c5-8f045b09cba9",
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        592,
        1424
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# Finance\n",
        "height": 520,
        "width": 1232,
        "color": 5
      },
      "id": "2aea18a7-6780-4928-8ef8-293041ba54a2",
      "name": "Sticky Note7",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        576,
        1344
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# ğŸ¤– AI-Powered Financial Document Processing Workflow\n\n## ğŸ“‹ Overview\nThis comprehensive workflow automates financial document processing using AI, handling invoices, expense receipts, and bank statements. It features four AI personas representing different financial roles and automatically extracts, categorizes, and stores financial data in Google Sheets.\n\n## â­ Key Features\n- ğŸ“„ **Multi-Document Support**: Processes invoices, expense receipts, and bank statements\n- ğŸ§  **AI-Powered Extraction**: Uses Google Gemini for intelligent data extraction\n- ğŸ·ï¸ **Automatic Categorization**: Smart expense categorization with 17 predefined categories\n- ğŸ’¬ **Financial Analysis Agent**: Query your financial data using natural language\n- ğŸ“ **Automated File Management**: Renames and organizes processed documents\n- ğŸ‘¥ **Role-Based Processing**: Four distinct AI personas for different financial functions\n\n## ğŸ”§ Workflow Components\n\n### 1. ğŸ“„ Invoice Processing (Mark - Accountant)\n**ğŸš€ Trigger**: Chat interface for invoice uploads\n**âš™ï¸ Process**:\n- ğŸ“¤ Upload invoice via chat interface\n- ğŸ§  AI extracts: Vendor Name, Invoice Number, Invoice Date, Due Date, Total Amount, VAT Amount, Line Items\n- ğŸ“Š Data saved to \"Test Invoice Records\" Google Sheet\n- ğŸ“ File automatically renamed as \"{Vendor Name} - {Invoice Number}\"\n- âœ… Confirmation message sent\n\n### 2. ğŸ§¾ Expense Processing (Donna - Accountant)\n**ğŸš€ Trigger**: Google Drive folder monitoring (\"Expense Receipts\")\n**âš™ï¸ Process**:\n- â° Monitors expense receipts folder every minute\n- ğŸ§  AI extracts: Merchant Name, Transaction Date, Total Amount, Tax Amount, Payment Method, Line Items\n- ğŸ·ï¸ Automatic expense categorization using predefined categories\n- ğŸ“Š Data saved to \"Expenses Recording\" Google Sheet\n\n**ğŸ“‹ Expense Categories**:\n- ğŸ“¦ Cost of Goods Sold\n- ğŸ“¢ Advertising & Marketing\n- ğŸ’° Payroll & Wages\n- ğŸ¯ Employee Benefits\n- ğŸ¤ Contract Labor\n- ğŸ¢ Rent & Leases\n- âš¡ Utilities\n- ğŸ“ Office Supplies & G&A\n- ğŸ’» Software & Cloud Subscriptions\n- âœˆï¸ Travel Meals & Entertainment\n- ğŸ‘” Professional Services\n- ğŸ›¡ï¸ Insurance\n- ğŸ”§ Repairs & Maintenance\n- ğŸ›ï¸ Taxes & Licenses\n- ğŸ’³ Interest Expense\n- ğŸ“‰ Depreciation & Amortization\n- ğŸ“‹ Other Miscellaneous\n\n### 3. ğŸ¦ Bank Statement Processing (Victor - Controller)\n**ğŸš€ Trigger**: Google Drive folder monitoring (\"Bank Statements\")\n**âš™ï¸ Process**:\n- â° Monitors bank statements folder every minute\n- ğŸ§  AI extracts: Transaction ID, Date, Description/Payee, Debit/Credit, Currency, Running Balance\n- ğŸ“Š Data saved to \"Bank Transactions Record\" Google Sheet\n\n### 4. ğŸ“ˆ Financial Analysis Agent (Andrew - CFO)\n**ğŸš€ Trigger**: Manual execution for financial queries\n**ğŸ¯ Capabilities**:\n- ğŸ—ƒï¸ Access to all three financial spreadsheets\n- ğŸ’¬ Natural language queries about financial data\n- ğŸ“Š Generate reports and insights\n- â“ Answer questions about invoices, expenses, and transactions\n\n## ğŸ› ï¸ Setup Requirements\n\n### ğŸŒ Google Services\n1. **ğŸš— Google Drive API** credentials configured\n2. **ğŸ“Š Google Sheets API** credentials configured  \n3. **ğŸ§  Google Gemini API** credentials configured\n4. **ğŸ¤– OpenRouter API** credentials for LLM categorization\n\n### ğŸ“ Required Google Drive Folders\nCreate these folders in your Google Drive:\n- ğŸ“„ \"Invoices\" (for processed invoice storage)\n- ğŸ§¾ \"Expense Receipts\" (monitored for new expense receipts)\n- ğŸ¦ \"Bank Statements\" (monitored for new bank statements)\n\n### ğŸ“Š Required Google Sheets\nCreate these spreadsheets with appropriate column headers:\n1. **ğŸ“„ \"Test Invoice Records\"** - Vendor Name, Invoice Number, Invoice Date, Due Date, Total Amount, VAT Amount, Line Item Description, Quantity, Unit Price, Total Price\n2. **ğŸ§¾ \"Expenses Recording\"** - Merchant Name, Transaction Date, Total Amount, Tax Amount, Payment Method, Line Item Description, Quantity, Unit Price, Total Price, Category\n3. **ğŸ¦ \"Bank Transactions Record\"** - Transaction ID, Date, Description/Payee, Debit (-), Credit (+), Currency, Running Balance, Notes/Category\n\n",
        "height": 2256,
        "width": 784
      },
      "id": "dba01383-1a18-44b1-b932-325962560ce4",
      "name": "Sticky Note9",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2432,
        1024
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# ğŸ› ï¸ Setup Requirements\n\n### ğŸŒ Google Services\n1. **ğŸš— Google Drive API** credentials configured\n2. **ğŸ“Š Google Sheets API** credentials configured  \n3. **ğŸ§  Google Gemini API** credentials configured\n4. **ğŸ¤– OpenRouter API** credentials for LLM categorization\n\n### ğŸ“ Required Google Drive Folders\nCreate these folders in your Google Drive:\n- ğŸ“„ \"Invoices\" (for processed invoice storage)\n- ğŸ§¾ \"Expense Receipts\" (monitored for new expense receipts)\n- ğŸ¦ \"Bank Statements\" (monitored for new bank statements)\n\n### ğŸ“Š Required Google Sheets\nCreate these spreadsheets with appropriate column headers:\n1. **ğŸ“„ \"Test Invoice Records\"** - Vendor Name, Invoice Number, Invoice Date, Due Date, Total Amount, VAT Amount, Line Item Description, Quantity, Unit Price, Total Price\n2. **ğŸ§¾ \"Expenses Recording\"** - Merchant Name, Transaction Date, Total Amount, Tax Amount, Payment Method, Line Item Description, Quantity, Unit Price, Total Price, Category\n3. **ğŸ¦ \"Bank Transactions Record\"** - Transaction ID, Date, Description/Payee, Debit (-), Credit (+), Currency, Running Balance, Notes/Category\n\n",
        "height": 640,
        "width": 784
      },
      "id": "d7a8b677-7c3b-46f2-81b4-122511508c4a",
      "name": "Sticky Note10",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1568,
        2656
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# ğŸ¯ How to Use\n\n### ğŸ“„ Processing Invoices\n1. ğŸ’¬ Access the chat interface\n2. ğŸ“¤ Upload PDF invoice files\n3. â³ Wait for AI processing and confirmation\n4. âœ… Check \"Test Invoice Records\" Google Sheet for extracted data\n5. ğŸ“ Processed files will be renamed and stored in \"Invoices\" folder\n\n### ğŸ§¾ Processing Expense Receipts\n1. ğŸ“¤ Upload PDF receipts to \"Expense Receipts\" Google Drive folder\n2. âš™ï¸ Workflow automatically processes new files every minute\n3. âœ… Check \"Expenses Recording\" Google Sheet for categorized expenses\n4. ğŸ·ï¸ AI automatically assigns appropriate expense categories\n\n### ğŸ¦ Processing Bank Statements\n1. ğŸ“¤ Upload PDF bank statements to \"Bank Statements\" Google Drive folder\n2. âš™ï¸ Workflow automatically processes new files every minute\n3. âœ… Check \"Bank Transactions Record\" Google Sheet for transaction data\n\n### ğŸ’¬ Querying Financial Data\n1. â–¶ï¸ Execute the \"When Executed by Another Workflow\" trigger\n2. ğŸ—£ï¸ Send natural language queries about your financial data\n3. ğŸ’¡ Examples:\n   - \"What are the last 10 bank transactions?\"\n   - \"What is the total value of invoices for December 2023?\"\n   - \"List all unpaid invoices sorted by amount\"\n   - \"What was our highest expense category last month?\"\n   - \"Show me transactions over $1000 in the past week\"\n\n## ğŸ“ Supported File Formats\n- **ğŸ“„ PDF files only** (invoices, receipts, bank statements)\n- ğŸ” Ensure documents are clear and legible for optimal AI extraction\n\n## âš ï¸ Error Handling\n- âœ… Workflow continues processing even if individual documents fail\n- ğŸ“ Error outputs are logged for troubleshooting\n- ğŸ”§ Failed extractions can be manually reviewed and corrected\n\n## ğŸ‘¥ AI Personas\n- **ğŸ“„ Mark (Accountant)**: Handles invoice processing with attention to vendor details and payment terms\n- **ğŸ§¾ Donna (Accountant)**: Manages expense categorization and receipt processing\n- **ğŸ¦ Victor (Controller)**: Oversees bank statement processing and transaction reconciliation\n- **ğŸ“ˆ Andrew (CFO)**: Provides high-level financial analysis and reporting\n\n## ğŸ‰ Benefits\n- â° **Time Savings**: Automates manual data entry from financial documents\n- ğŸ¯ **Accuracy**: AI-powered extraction reduces human error\n- ğŸ“‚ **Organization**: Automatic file naming and categorization\n- ğŸ’¡ **Insights**: Query financial data using natural language\n- ğŸ“ˆ **Scalability**: Processes multiple documents simultaneously\n- ğŸ›¡ï¸ **Compliance**: Maintains organized records for accounting and audit purposes\n\n## ğŸ”§ Troubleshooting\n- âœ… Ensure all API credentials are properly configured\n- ğŸ“ Verify Google Drive folder permissions allow the workflow to access files\n- ğŸ“Š Check that Google Sheets have the correct column headers\n- ğŸ“ Monitor workflow execution logs for any processing errors\n- ğŸ“„ Test with clear, high-quality PDF documents for best resultshooting\n- Ensure all API credentials are properly configured\n- Verify Google Drive folder permissions allow the workflow to access files\n- Check that Google Sheets have the correct column headers\n- Monitor workflow execution logs for any processing errors\n- Test with clear, high-quality PDF documents for best results",
        "height": 1600,
        "width": 784
      },
      "id": "878a2809-70be-4883-a0cf-0ad2ebbb6813",
      "name": "Sticky Note11",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1568,
        1024
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# ğŸ“„ INVOICE PROCESSING SECTION\n\n## ğŸ¯ Purpose\nThis section handles invoice processing through a chat interface. Mark, the AI Accountant, extracts key invoice data and stores it in Google Sheets.\n\n## ğŸ”„ Process Flow\n1. **ğŸ’¬ Chat Trigger**: Users upload PDF invoices via chat\n2. **ğŸ“ File Storage**: Invoice saved to Google Drive \"Invoices\" folder\n3. **ğŸ¤– AI Processing**: Google Gemini extracts invoice data\n4. **ğŸ“Š Data Storage**: Information saved to \"Test Invoice Records\" spreadsheet\n5. **ğŸ“ File Renaming**: File renamed as \"{Vendor Name} - {Invoice Number}\"\n6. **âœ… Confirmation**: Success message sent to user\n\n## ğŸ“‹ Extracted Fields\n- Vendor Name\n- Invoice Number\n- Invoice Date\n- Due Date\n- Total Amount\n- VAT Amount\n- Line Items (Description, Quantity, Unit Price, Total Price)\n\n## âš™ï¸ Configuration Notes\n- Chat trigger allows all file types but processes PDF only\n- Error handling continues processing even if extraction fails\n- Files are stored with original name then renamed after processing",
        "height": 1112,
        "width": 772,
        "color": 5
      },
      "id": "fa891a39-8030-457d-8845-487fea8e161d",
      "name": "ğŸ“„ Invoice Processing Documentation",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -672,
        4320
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# Mark - Accountant ğŸ‘¨â€ğŸ’¼\n\n**Role**: Invoice Processing Specialist\n\n**Responsibilities**:\n- âœ… Extract vendor information\n- âœ… Capture payment terms\n- âœ… Process line item details\n- âœ… Ensure data accuracy\n\n**AI Capabilities**:\n- ğŸ§  Intelligent field recognition\n- ğŸ“‹ Structured data extraction\n- ğŸ” Quality validation",
        "height": 528,
        "width": 324,
        "color": 6
      },
      "id": "abd26488-82bc-43ce-b373-950e00f3fd2b",
      "name": "Mark - Accountant",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        208,
        4336
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# ğŸ“¤ STEP 1: File Upload & Storage\n\n**Purpose**: Save uploaded invoice to Google Drive\n\n**Configuration**:\n- ğŸ“ Target Folder: \"Invoices\"\n- ğŸ“„ Input Field: data0 (from chat upload)\n- ğŸ“ Filename: Uses original uploaded filename\n\n**Output**: File ID and metadata for downstream processing",
        "height": 488,
        "width": 268,
        "color": 3
      },
      "id": "6a32daf5-a8a7-42fc-8c2a-904a5d84aa55",
      "name": "ğŸ’¾ Save File Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        208,
        4896
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# ğŸ¤– STEP 2: AI Upload\n\n**Purpose**: Upload PDF to Google Gemini for processing\n\n**Configuration**:\n- ğŸ”— Endpoint: Gemini File Upload API\n- ğŸ“„ Content-Type: application/pdf\n- ğŸ” Auth: Google PaLM API credentials\n- ğŸ“Š Input: Binary data from chat upload\n\n**Output**: File URI for Gemini processing",
        "height": 488,
        "width": 220,
        "color": 3
      },
      "id": "5cfb0b8c-7125-44f8-8f87-3d18e66f5191",
      "name": "ğŸ¤– Upload to AI Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        496,
        4896
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# ğŸ§  STEP 3: Data Extraction\n\n**Purpose**: Use Gemini AI to extract structured invoice data\n\n**AI Prompt**: Extracts:\n- ğŸ¢ Vendor Name\n- ğŸ”¢ Invoice Number\n- ğŸ“… Invoice Date\n- ğŸ“… Due Date\n- ğŸ’° Total Amount\n- ğŸ’° VAT Amount\n- ğŸ“‹ Line Items\n\n**Output**: JSON structured data or plain text summary",
        "height": 488,
        "width": 252,
        "color": 3
      },
      "id": "5c341ad5-c4f5-4a1c-be31-07873bf2b319",
      "name": "ğŸ§  Data Extraction Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        736,
        4896
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# ğŸ“‹ STEP 4: JSON Parsing\n\n**Purpose**: Clean and parse AI response into structured data\n\n**Process**:\n- ğŸ§¹ Remove markdown code blocks\n- ğŸ“Š Convert text to JSON object\n- âš ï¸ Handle parsing errors gracefully\n- ğŸ”„ Retry on failure\n\n**Output**: Clean parsedData object for spreadsheet",
        "height": 488,
        "width": 236,
        "color": 3
      },
      "id": "8c2f170f-85d2-4db8-bc10-c1848131ba80",
      "name": "ğŸ“‹ JSON Parsing Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1008,
        4896
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# ğŸ“‘ STEP 5: Line Item Processing\n\n**Purpose**: Split line items for individual spreadsheet rows\n\n**Process**:\n- ğŸ“‹ Extract Line Items array from parsed data\n- ğŸ”„ Create separate execution for each line item\n- ğŸ“Š Enables detailed item-level tracking\n\n**Output**: Individual line items for Google Sheets",
        "height": 488,
        "width": 236,
        "color": 3
      },
      "id": "f84fba91-5961-4820-aca7-8abce292a9d0",
      "name": "ğŸ“‘ Split Items Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1264,
        4896
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# ğŸ“Š STEP 6: Save to Spreadsheet\n\n**Purpose**: Store extracted invoice data in Google Sheets\n\n**Mapping**:\n- ğŸ¢ Vendor Name â†’ Header data\n- ğŸ”¢ Invoice Number â†’ Header data\n- ğŸ“… Dates â†’ Header data\n- ğŸ’° Amounts â†’ Header data\n- ğŸ“‹ Line Items â†’ Individual rows\n\n**Sheet**: Test Invoice Records\n**Format**: USER_ENTERED (preserves formatting)",
        "height": 488,
        "width": 268,
        "color": 3
      },
      "id": "422aabb3-a5fd-4408-a61c-7acd343d37eb",
      "name": "ğŸ“Š Save to Sheet Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1520,
        4896
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# ğŸ”— STEP 7: Data Merge\n\n**Purpose**: Combine file metadata with processed data\n\n**Inputs**:\n- ğŸ“ File information from Google Drive\n- ğŸ“Š Processed invoice data from sheets\n\n**Output**: Combined data for file renaming",
        "height": 486,
        "width": 218,
        "color": 3
      },
      "id": "a1bdb6aa-2873-46d4-b0a8-f5d0aff6cb66",
      "name": "ğŸ”— Merge Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1808,
        4896
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# ğŸ“ STEP 8: File Renaming\n\n**Purpose**: Rename file with vendor and invoice number\n\n**Format**: \"{Vendor Name} - {Invoice Number}\"\n\n**Example**: \"Acme Corp - INV-2024-001\"\n\n**Error Handling**: Continues even if renaming fails",
        "height": 486,
        "width": 202,
        "color": 3
      },
      "id": "feb5e6a3-ab79-4dbc-9bc3-e88ab7658d62",
      "name": "ğŸ“ Rename Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2048,
        4896
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# âœ… STEP 9: Confirmation\n\n**Purpose**: Send success message to user\n\n**Message**: Confirms invoice processing completion\n\n**Includes**: Reference to check Google Sheet\n\n**User Experience**: Clear feedback on completion",
        "height": 486,
        "width": 250,
        "color": 3
      },
      "id": "13214330-13f4-4db7-b1a0-77356a9d864b",
      "name": "âœ… Confirmation Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2272,
        4896
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# ğŸ§¾ EXPENSE PROCESSING SECTION\n\n## ğŸ¯ Purpose\nThis section monitors a Google Drive folder for new expense receipts. Donna, the AI Accountant, extracts expense data and automatically categorizes it using AI.\n\n## ğŸ”„ Process Flow\n1. **ğŸ“ Drive Monitor**: Watches \"Expense Receipts\" folder every minute\n2. **ğŸ“¥ File Download**: Downloads new PDF files\n3. **ğŸ¤– AI Processing**: Google Gemini extracts expense data\n4. **ğŸ·ï¸ AI Categorization**: OpenRouter LLM categorizes expenses\n5. **ğŸ“Š Data Storage**: Information saved to \"Expenses Recording\" spreadsheet\n6. **âœ… Completion**: Process confirmation\n\n## ğŸ“‹ Extracted Fields\n- Merchant Name\n- Transaction Date\n- Total Amount\n- Tax Amount\n- Payment Method\n- Line Items (if available)\n- AI-Generated Category\n\n## ğŸ·ï¸ Expense Categories (17 Total)\n- ğŸ“¦ Cost of Goods Sold\n- ğŸ“¢ Advertising & Marketing\n- ğŸ’° Payroll & Wages\n- ğŸ¯ Employee Benefits\n- ğŸ¤ Contract Labor\n- ğŸ¢ Rent & Leases\n- âš¡ Utilities\n- ğŸ“ Office Supplies & G&A\n- ğŸ’» Software & Cloud Subscriptions\n- âœˆï¸ Travel Meals & Entertainment\n- ğŸ‘” Professional Services\n- ğŸ›¡ï¸ Insurance\n- ğŸ”§ Repairs & Maintenance\n- ğŸ›ï¸ Taxes & Licenses\n- ğŸ’³ Interest Expense\n- ğŸ“‰ Depreciation & Amortization\n- ğŸ“‹ Other Miscellaneous\n\n## âš™ï¸ Configuration Notes\n- Monitors folder every minute for new files\n- Processes PDF files automatically\n- AI categorization uses structured output parsing\n- Error handling continues processing other files",
        "height": 1232,
        "width": 772,
        "color": 5
      },
      "id": "84a7dfab-7443-4fa7-bd4e-e7839ec66ac4",
      "name": "ğŸ§¾ Expense Processing Documentation",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -672,
        3056
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# ğŸ“ EXPENSE TRIGGER\n\n**Purpose**: Monitor Google Drive folder for new expense receipts\n\n**Configuration**:\n- ğŸ“‚ Folder: \"Expense Receipts\"\n- â° Frequency: Every minute\n- ğŸš¨ Event: File created\n- ğŸ“„ File Types: All (but processes PDF)\n\n**Output**: File metadata for new uploads",
        "height": 296,
        "width": 492,
        "color": 4
      },
      "id": "dd933b39-112f-4ab6-bb3b-ba082a9b4a09",
      "name": "ğŸ“ Expense Trigger Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2192,
        3680
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# ğŸ·ï¸ AI CATEGORIZATION\n\n**Purpose**: Automatically categorize expenses using AI\n\n**Process**:\n- ğŸ¤– Uses OpenRouter LLM\n- ğŸ“‹ 17 predefined categories\n- ğŸ¯ Structured JSON output\n- ğŸ§  Context-aware classification\n\n**Output**: Category assignment for expense",
        "height": 296,
        "width": 492,
        "color": 4
      },
      "id": "452bbd1a-4139-4f30-8acb-57d9da6e8ead",
      "name": "ğŸ·ï¸ Categorization Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2192,
        3360
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# ğŸ¦ BANK STATEMENT PROCESSING SECTION\n\n## ğŸ¯ Purpose\nThis section monitors a Google Drive folder for new bank statements. Victor, the AI Controller, extracts transaction data for reconciliation and analysis.\n\n## ğŸ”„ Process Flow\n1. **ğŸ“ Drive Monitor**: Watches \"Bank Statements\" folder every minute\n2. **ğŸ“¥ File Download**: Downloads new PDF bank statements\n3. **ğŸ¤– AI Processing**: Google Gemini extracts transaction data\n4. **ğŸ”„ Data Parsing**: Custom code handles multiple transactions\n5. **ğŸ“Š Data Storage**: Information saved to \"Bank Transactions Record\" spreadsheet\n6. **âœ… Completion**: Process confirmation\n\n## ğŸ“‹ Extracted Fields\n- Transaction ID\n- Date\n- Description / Payee\n- Debit (-)\n- Credit (+)\n- Currency\n- Running Balance\n- Notes / Category (optional)\n\n## âš™ï¸ Configuration Notes\n- Monitors folder every minute for new files\n- Processes PDF bank statements automatically\n- Custom JavaScript code handles transaction arrays\n- Error handling continues processing other files\n- Supports multiple transaction formats",
        "height": 856,
        "width": 772,
        "color": 5
      },
      "id": "c032f254-d81d-407a-b38d-2c81b3824017",
      "name": "ğŸ¦ Bank Statement Processing Documentation",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -672,
        2176
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# Victor - Controller ğŸ‘¨â€ğŸ’¼\n\n**Role**: Bank Statement Processing & Transaction Reconciliation\n\n**Responsibilities**:\n- âœ… Extract transaction details\n- âœ… Process multiple transactions per statement\n- âœ… Maintain running balances\n- âœ… Handle various bank formats\n\n**AI Capabilities**:\n- ğŸ§  Multi-transaction extraction\n- ğŸ“Š Balance reconciliation\n- ğŸ”„ Format standardization",
        "height": 512,
        "width": 324,
        "color": 6
      },
      "id": "82717232-0097-474d-b283-9a53619fecb0",
      "name": "Victor - Controller",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        208,
        2368
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# ğŸ”„ CUSTOM TRANSACTION PARSER\n\n**Purpose**: Parse multiple bank transactions from AI response\n\n**Features**:\n- ğŸ§¹ Cleans JSON formatting\n- ğŸ“Š Handles multiple response formats\n- ğŸ”„ Converts to n8n array format\n- âš ï¸ Comprehensive error handling\n\n**Output**: Individual transaction objects",
        "height": 504,
        "width": 348,
        "color": 4
      },
      "id": "af11afb5-9995-4f14-8227-2ab1b0c9936e",
      "name": "ğŸ”„ Bank Parser Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2720,
        2368
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# ğŸ“ˆ FINANCIAL ANALYSIS AGENT SECTION\n\n## ğŸ¯ Purpose\nAndrew, the AI CFO, provides intelligent financial analysis and reporting. He can access all three financial spreadsheets and answer complex queries using natural language.\n\n## ğŸ”„ Process Flow\n1. **â–¶ï¸ Manual Trigger**: Execute when financial analysis is needed\n2. **ğŸ¤– AI Agent**: Uses advanced LLM for data analysis\n3. **ğŸ“Š Data Access**: Connects to all three Google Sheets\n4. **ğŸ’¬ Natural Language**: Processes queries in plain English\n5. **ğŸ“ˆ Analysis**: Generates insights and reports\n6. **ğŸ“‹ Response**: Formatted results and recommendations\n\n## ğŸ—ƒï¸ Data Access\n- **ğŸ“„ Invoices**: Client billing and payment tracking\n- **ğŸ§¾ Expenses**: Categorized expense analysis\n- **ğŸ¦ Transactions**: Bank account reconciliation\n\n## ğŸ’¡ Query Examples\n- \"What are the last 10 bank transactions?\"\n- \"What is the total value of invoices for December 2023?\"\n- \"List all unpaid invoices sorted by amount\"\n- \"What was our highest expense category last month?\"\n- \"Show me transactions over $1000 in the past week\"\n- \"Calculate the average invoice amount by client\"\n- \"Compare Q3 vs Q4 expenses by category\"\n- \"Generate a cash flow summary for the last quarter\"\n\n## ğŸ¤– AI Capabilities\n- **ğŸ“Š Data Analysis**: Complex calculations and aggregations\n- **ğŸ“ˆ Trend Analysis**: Identify patterns and insights\n- **ğŸ“‹ Report Generation**: Structured financial reports\n- **ğŸ’¬ Natural Language**: No SQL or technical knowledge required\n- **ğŸ” Data Mining**: Find specific transactions or patterns\n\n## âš™ï¸ Configuration Notes\n- Uses GPT-4.1 via OpenRouter for advanced reasoning\n- Connected to all three financial spreadsheets as tools\n- Disabled by default - enable when analysis is needed\n- Maintains data confidentiality and security",
        "height": 1104,
        "width": 756,
        "color": 5
      },
      "id": "1a7e1b31-2953-4ac4-9e34-d5046c2421e7",
      "name": "ğŸ“ˆ Financial Analysis Documentation",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -672,
        1024
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# Andrew - CFO ğŸ‘¨â€ğŸ’¼\n\n**Role**: Financial Analysis & Strategic Reporting\n\n**Responsibilities**:\n- âœ… Generate financial insights\n- âœ… Answer complex queries\n- âœ… Create executive reports\n- âœ… Provide strategic recommendations\n\n**AI Capabilities**:\n- ğŸ§  Advanced data analysis\n- ğŸ“Š Multi-source data synthesis\n- ğŸ’¬ Natural language processing\n- ğŸ“ˆ Trend identification",
        "height": 512,
        "width": 308,
        "color": 6
      },
      "id": "2e6ab7c3-0d06-475c-9ce4-ebd9a0639a9f",
      "name": "Andrew - CFO",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        224,
        1344
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# ğŸ“Š ANALYSIS TRIGGER\n\n**Purpose**: Manual trigger for financial analysis queries\n\n**Usage**:\n- ğŸ”˜ Enable this trigger when analysis is needed\n- ğŸ’¬ Send financial queries to the AI agent\n- ğŸ“ˆ Get insights from all your financial data\n\n**Note**: Disabled by default for security",
        "height": 518,
        "width": 300,
        "color": 4
      },
      "id": "0871bd02-686f-42a0-9e1b-8bf1ee83861c",
      "name": "ğŸ“Š Analysis Trigger Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1840,
        1344
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# ğŸ—ƒï¸ DATA ACCESS TOOLS\n\n**Purpose**: Connect AI agent to financial spreadsheets\n\n**Tools Available**:\n- ğŸ“„ **Invoices Tool**: Invoice records and billing data\n- ğŸ§¾ **Expenses Tool**: Categorized expense tracking\n- ğŸ¦ **Transactions Tool**: Bank transaction history\n\n**Features**:\n- ğŸ” Auto-detect data ranges\n- ğŸ“Š Full spreadsheet access\n- ğŸ” Secure authentication\n- ğŸ“ˆ Real-time data access",
        "height": 520,
        "width": 302,
        "color": 4
      },
      "id": "8bfa35b4-78a0-4006-bf6f-839d560d7923",
      "name": "ğŸ—ƒï¸ Data Tools Instructions",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2176,
        1344
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# Donna - Accountant ğŸ‘©â€ğŸ’¼\n\n**Role**: Expense Processing & Categorization Specialist\n\n**Responsibilities**:\n- âœ… Extract merchant & transaction details\n- âœ… Categorize expenses automatically\n- âœ… Process receipt line items\n- âœ… Ensure compliance categorization\n\n**AI Capabilities**:\n- ğŸ§  Smart expense categorization\n- ğŸ“‹ Receipt data extraction\n- ğŸ·ï¸ 17-category classification system",
        "height": 608,
        "width": 324,
        "color": 6
      },
      "id": "80550d1d-d330-48f2-9603-9a5fdfb998fb",
      "name": "Donna - Accountant",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        208,
        3360
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "",
        "height": 1152,
        "width": 2416,
        "color": 7
      },
      "id": "20bc405b-ad29-434e-9297-cb0ca5183f6e",
      "name": "Sticky Note13",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        176,
        4304
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "",
        "height": 688,
        "width": 2544,
        "color": 7
      },
      "id": "3a14b73e-ff0d-4d93-afd1-876025f6f285",
      "name": "Sticky Note14",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        176,
        3328
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "",
        "height": 576,
        "width": 2928,
        "color": 7
      },
      "id": "ba8d18f7-6d55-4ab8-896b-38bf6187e299",
      "name": "Sticky Note15",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        176,
        2336
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "",
        "height": 608,
        "width": 2352,
        "color": 7
      },
      "id": "0d67abf7-921c-46b7-a717-7f099b9c8c70",
      "name": "Sticky Note16",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        176,
        1296
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "![My Image](https://i.postimg.cc/k4nQdT9X/replicate-prediction-w27bjb3hxxrm80csj5t8211288.jpg)",
        "height": 784,
        "width": 1312,
        "color": 7
      },
      "id": "754328bd-68d5-429d-bdc1-f57bee7d5485",
      "name": "Sticky Note27",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -384,
        128
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "# Virtual Accounting Department",
        "height": 80,
        "width": 544
      },
      "id": "03f100bc-aada-4923-8f87-b93cb89bc55d",
      "name": "Sticky Note8",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0,
        0
      ],
      "typeVersion": 1
    }
  ],
  "pinData": {},
  "connections": {
    "Code": {
      "main": [
        [
          {
            "node": "Google Sheets1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Update File Name",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Edit Fields2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Expenses": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Invoices": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Split Out": {
      "main": [
        [
          {
            "node": "Table ERP",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Table ERP": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Split Out1": {
      "main": [
        [
          {
            "node": "Basic LLM Chain",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parsed Data": {
      "main": [
        [
          {
            "node": "Split Out",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Drive": {
      "main": [
        [
          {
            "node": "Upload PDF to Google Gemini1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parsed Data1": {
      "main": [
        [
          {
            "node": "Split Out1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Save Invoice": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Transactions": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Google Drive1": {
      "main": [
        [
          {
            "node": "Upload PDF to Google Gemini2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets": {
      "main": [
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets1": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Basic LLM Chain": {
      "main": [
        [
          {
            "node": "Google Sheets",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update File Name": {
      "main": [
        [
          {
            "node": "Confirmation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Drive Trigger": {
      "main": [
        [
          {
            "node": "Google Drive",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Drive Trigger1": {
      "main": [
        [
          {
            "node": "Google Drive1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Basic LLM Chain",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "Basic LLM Chain",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "When chat message received": {
      "main": [
        [
          {
            "node": "Upload PDF to Google Gemini",
            "type": "main",
            "index": 0
          },
          {
            "node": "Save Invoice",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload PDF to Google Gemini": {
      "main": [
        [
          {
            "node": "Download Data from Google Gemini",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload PDF to Google Gemini1": {
      "main": [
        [
          {
            "node": "Download Data from Google Gemini1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Upload PDF to Google Gemini2": {
      "main": [
        [
          {
            "node": "Download Data from Google Gemini2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download Data from Google Gemini": {
      "main": [
        [
          {
            "node": "Parsed Data",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Upload PDF to Google Gemini",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download Data from Google Gemini1": {
      "main": [
        [
          {
            "node": "Parsed Data1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Upload PDF to Google Gemini1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download Data from Google Gemini2": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Upload PDF to Google Gemini2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When Executed by Another Workflow": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "de70f62e-bbdc-4ffe-8b25-8d2b81713d09",
  "meta": {
    "instanceId": "4a46cb8e41c17d2d949ec0638176f8b1ba0a72ea622fd712e7f978687e1f6ac7"
  },
  "id": "Zcxgdy9goGjOLzV2",
  "tags": []
}